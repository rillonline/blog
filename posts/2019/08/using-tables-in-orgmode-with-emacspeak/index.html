<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Using Tables in Orgmode with Emacspeak | Rill's Blog</title>
<link href="../../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Playfair+Display:700,900" rel="stylesheet">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../../../rss.xml">
<link rel="canonical" href="https://rillonline.github.io/blog/posts/2019/08/using-tables-in-orgmode-with-emacspeak/">
<!--[if lt IE 9]><script src="../../../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Rill">
<link rel="prev" href="../tab-completion-in-orgmode/" title="Tab Completion in Orgmode" type="text/html">
<link rel="next" href="../recurring-tasks-in-orgmode/" title="Recurring Tasks in Orgmode" type="text/html">
<meta property="og:site_name" content="Rill's Blog">
<meta property="og:title" content="Using Tables in Orgmode with Emacspeak">
<meta property="og:url" content="https://rillonline.github.io/blog/posts/2019/08/using-tables-in-orgmode-with-emacspeak/">
<meta property="og:description" content="I wanted to know how much my subscriptions were costing me every
month. Subscription fatigue is a popular topic on tech talk shows so I
wanted to see how my useage stacked up and if there was anything">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2019-08-27T00:00:00-05:00">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Header and menu bar -->
<div class="container">
      <header class="blog-header py-3"><div class="row nbb-header align-items-center">
          <div class="col-md-3 col-xs-2 col-sm-2" style="width: auto;">
            <button class="navbar-toggler navbar-light bg-light nbb-navbar-toggler" type="button" data-toggle="collapse" data-target=".bs-nav-collapsible" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse bs-nav-collapsible bootblog4-search-form-holder">
                
            </div>
        </div>
          <div class="col-md-6 col-xs-10 col-sm-10 bootblog4-brand" style="width: auto;">
            <a class="navbar-brand blog-header-logo text-dark" href="../../../../">

            <span id="blog-title">Rill's Blog</span>
        </a>
          </div>
            <div class="col-md-3 justify-content-end align-items-center bs-nav-collapsible collapse flex-collapse bootblog4-right-nav">
            <nav class="navbar navbar-light bg-white"><ul class="navbar-nav bootblog4-right-nav">
<li class="nav-item">
    <a href="index.rst" id="sourcelink" class="nav-link">Source</a>
    </li>


                    
            </ul></nav>
</div>
    </div>
</header><nav class="navbar navbar-expand-md navbar-light bg-white static-top"><div class="collapse navbar-collapse bs-nav-collapsible" id="bs-navbar">
            <ul class="navbar-nav nav-fill d-flex w-100">
<li class="nav-item">
<a href="../../../../archive.html" class="nav-link">Archive</a>
                </li>
<li class="nav-item">
<a href="../../../../categories/" class="nav-link">Tags</a>
                </li>
<li class="nav-item">
<a href="../../../../rss.xml" class="nav-link">RSS feed</a>

                
            </li>
</ul>
</div>
<!-- /.navbar-collapse -->
</nav>
</div>

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
        
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Using Tables in Orgmode with Emacspeak</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    Rill
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2019-08-27T00:00:00-05:00" itemprop="datePublished" title="2019-08-27 00:00">2019-08-27 00:00</time></a>
            </p>
            
        <p class="sourceline"><a href="index.rst" class="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div>
<p>I wanted to know how much my subscriptions were costing me every
month. Subscription fatigue is a popular topic on tech talk shows so I
wanted to see how my useage stacked up and if there was anything
outrageous I could cut.</p>
<p>There are a number of tools at my disposal:</p>
<ul class="simple">
<li><p>A Perkins Brailler and a sheet of paper. I still know how to add up
a column of figures manually.</p></li>
<li>
<p>A spreadsheet program. Let me count the options I have, not going
into how well I think they work or how well I know them.</p>
<ul>
<li><p>Microsoft Excel</p></li>
<li><p>LibriOffice Calc</p></li>
<li><p>Numbers</p></li>
<li><p>ses</p></li>
<li><p>dismal</p></li>
<li><p>Org</p></li>
</ul>
</li>
</ul>
<p>Although not in my little list above, I know word processor programs
have tables and the possibility of formulas, but I decided I could
investigate org tables. I could report on their accessibility with help from Emacspeak.</p>
<div class="section" id="setting-up-a-table">
<h2>Setting Up A Table</h2>
<p>I decided to create a table with two columns, "ITEM" for the name of
the subscription and "ExPENSE" for the monthly amount I am
spending.</p>
<p>There's nothing fancy about setting up an org table. The vertical bar
character "|" delimits columns. If a "|" is the first character in a
line, org understands this to be a table. A two column table with one
row looks like this:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">&lt;string&gt;</span>, line 36)</p>
<p>Cannot find pygments lexer for language "example"</p>
<pre class="literal-block">.. code:: example


   | | |
</pre>
</div>
<p>But I need a table with two headers, a horizontal rule between my
headings and my subscriptions and one row to start.</p>
<p><strong>Note</strong>: You need a header row with a horizontal rule underneath it if you want to total a column of numbers.</p>
<ol class="arabic">
<li>
<p>Type the line</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">&lt;string&gt;</span>, line 48)</p>
<p>Cannot find pygments lexer for language "example"</p>
<pre class="literal-block">.. code:: example


   |ITEM|ExPENSE|
</pre>
</div>
<p>Press return. Don't worry about white space</p>
</li>
<li>
<p>Type "<a href="#id1"><span class="problematic" id="id2">|</span></a>-" (vertical bar followed immediately by a hyphen) and press
tab.</p>
<div class="system-message" id="id1">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">&lt;string&gt;</span>, line 54); <em><a href="#id2">backlink</a></em></p>
<p>Inline substitution_reference start-string without end-string.</p>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">&lt;string&gt;</span>, line 57)</p>
<p>Cannot find pygments lexer for language "example"</p>
<pre class="literal-block">.. code:: example

   | ITEM | ExPENSE |
   |------+---------|
   |      |         |
</pre>
</div>
</li>
<li><p>Now you have a table ready for input.Your column headings have
white space around them and your horizontal rule is filled in. The
vertical bars to define the columns in the new row are in place.</p></li>
</ol>
</div>
<div class="section" id="entering-data-into-a-table">
<h2>Entering Data into A Table</h2>
<p>Once the table is set up like this, it is an easy process to fill in many lines of data.</p>
<ol class="arabic">
<li><p>With point at the third position, type "Amazon Prime".</p></li>
<li><p>Press tab. Point is at the third position after the second "|".</p></li>
<li><p>Type "8.25" for one month of the $99 subscription.</p></li>
<li><p>Press return.</p></li>
<li>
<p>Here's what the table now looks like. Notice that the columns have
been adjusted to accommodate the longer text of "Amazon Prime".</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">&lt;string&gt;</span>, line 79)</p>
<p>Cannot find pygments lexer for language "example"</p>
<pre class="literal-block">.. code:: example

   | ITEM         | EXPENSE  |
   |--------------+---------|
   | Amazon Prime |       8.25   |
   |              |              |
</pre>
</div>
</li>
</ol>
<p>It is important to realize that point is now in the second column.
Either use s=tab to move back one field to the first column or c-a to
go to the beginning of the line and c-f to move to the right of the "|".</p>
</div>
<div class="section" id="summing-up-expenses">
<h2>Summing Up Expenses</h2>
<p>When I thought I had listed all my subscriptions, I made another
horizontal rule.</p>
<ol class="arabic simple">
<li><p>I typed the word "Total" in the first column.</p></li>
<li><p>I pressed tab.</p></li>
<li><p>I pressed "C-c +" (c-c then the plus sign). This summed up my
expenses and put it in the echo line.</p></li>
<li><p>I pressed "c-y" to paste (yank) it into the table at point.</p></li>
<li><p>Now I could read the number.</p></li>
</ol>
<p>This is fine, but if I added another subscription (perish the
thought!) I would have to go through the process of updating the total
more or less manually. I needed a formula that I could rerun at any
time. Who knows. I might even drop a subscription down the road.</p>
</div>
<div class="section" id="some-discoveries">
<h2>Some Discoveries</h2>
<p>I created a much more complicated table with many headings for
different kinds of expenses. Most of every column had white space in
it with a few numbers. This doesn't work in Org. The columns cannot be
summarized. Following the example of<a class="reference external" href="http://www.howardism.org/Technical/Emacs/spreadsheet.html">Lots of Small Spreadsheets</a> I broke
my mammoth spreadsheet into six little ones:</p>
<ul class="simple">
<li><p>subscriptions</p></li>
<li><p>rent and such</p></li>
<li><p>health and wellness</p></li>
<li><p>food and drink</p></li>
<li><p>dog (for my Seeing Eye dog)</p></li>
<li><p>Miscellaneous</p></li>
</ul>
<p>Then I created a seventh table to summarize them all.</p>
</div>
<div class="section" id="naming-tables">
<h2>Naming Tables</h2>
<p>If each of these tables has a unique name, any field in that table can be
referenced elsewhere in the Org universe. It looks like this:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">&lt;string&gt;</span>, line 132)</p>
<p>Cannot find pygments lexer for language "example"</p>
<pre class="literal-block">.. code:: example

   #+NAME: subscriptions
</pre>
</div>
<p>Put this name at the top of the table above the header row. Don't have
any white space in-between this line and the header line. Org needs to
understand they are connected.</p>
</div>
<div class="section" id="how-org-references-rows-and-columns">
<h2>How Org References Rows and Columns</h2>
<p>To find out where you are in a table, use "c-c ?" (c-c question mark).
To hear the reference again, press "c-e a". You can do this as many
times as you need to until you have it in your mind. I don't know of a
way to put it on the clipboard to be yanked into a text file to be
interrogated.</p>
<p>The readout is in the form line number which is prefixed by the "@" (at sign) followed by the
word "col" followed by the column designation in the form "$" (dollar
sign) followed by the column position followed by the compound
expression of row plus column. Finally, a more conventional
spreadsheet reference. So the field in the seventh row in the fifth column is "@7$5" or "G5".</p>
</div>
<div class="section" id="putting-it-altogether">
<h2>Putting It Altogether</h2>
<p>Each of our little tables needs a formula to sum up the expenses
listed in column 2. You write this formula this way:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">&lt;string&gt;</span>, line 161)</p>
<p>Cannot find pygments lexer for language "example"</p>
<pre class="literal-block">.. code:: example

   #+TBLFM: @&gt;$2=vsum(@2..@-1)
</pre>
</div>
<ol class="arabic simple">
<li><p>"#+TBLFM:" follows the table itself with no white space. I could
not get more than one of these to work per table.</p></li>
<li><p>The left hand side of the equation shows where to put the answer.
Put it in the last row, second column.</p></li>
<li><p>"vsum" is an Emacs calc function. It will summarize the column for us.</p></li>
<li><p>Within the parentheses is the range: from the second row to the
next to last row in the second column. Org does not count the
horizontal lines but it will stop any calculation when it
encounters one.</p></li>
<li><p>Press "c-c c-c" on this line and voila! The total appears.</p></li>
</ol>
<p>*Note*: Always blank out your field(s) before initiating a
calculation. You will get some strange numbers if you don't.</p>
</div>
<div class="section" id="the-final-summation">
<h2>The Final Summation</h2>
<p>Finally, I needed to add the totals from the six tables into
the seventh one. Obviously, I could look at each number and copy it over,
but what fun is that? Besides, every time I added an item to one of
the tables, I would have to copy a new number into the correct field.</p>
<p>Enter "#+NAME:" to save the day.</p>
<p>I wrote a formula to pick up the total amount from each table, copy it
to the appropriate line in the second column of my summary table and
add it all up. No matter how hard I tried, I couldn't get the hang of
doing these remote references within the table so I have one huge
"#+TBLFM:" line. It may not be pretty but it works! Here's what it
looks like. It will probably wrap on your screen, but trust me, it's
one line in my file.</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">&lt;string&gt;</span>, line 197)</p>
<p>Cannot find pygments lexer for language "example"</p>
<pre class="literal-block">.. code:: example

   #+TBLFM:@2$2=remote(subscriptions,@&gt;$2)::@3$2=remote(rent-and-such,@&gt;$2)::@4$2=remote(health-and-wellness,@&gt;$2)::@5$2=remote(dog,@&gt;$2)::@6$2=remote(food-and-drink,@&gt;$2)::@7$2=remote(misc,@&gt;$2)::@&gt;$2=vsum(@2$2..@&gt;-1$2)
</pre>
</div>
<p>The double "::" (colon) concatenates each equation to the next. When it
all finally worked, the entire column was filled in and the grand
total appeared.</p>
</div>
<div class="section" id="some-observations">
<h2>Some Observations</h2>
<ul class="simple">
<li><p>"C-c spc" is a great keybinding to know. It blanks out a field.</p></li>
<li><p>Learning how to delete a column or row is useful. Don't be too
zealous. You'll end up wiping out all your hard work entering it.
Moving rows up and down can be accomplished with keybindings, too.
You can learn about all these by going through the tbl menu option. It's good when you don't remember a keybinding like I do.</p></li>
<li><p>I did not find the formula debugger very helpful.</p></li>
<li><p>I had trouble when my table only had one line of data. The range
confused the program.</p></li>
<li><p>If you need to, you can export your table to a csv file.</p></li>
<li><p>Being very specific in formulas helps a lot. There are some
shortcuts for cell descriptions, but some of them were harder to
understand and use for me. When I got specific, my formulas worked
much better.</p></li>
<li><p>The emacspeak keybindings appear to be duplicates of the org ones.</p></li>
<li><p>With simple tables, it is not too hard to review the table with speech.</p></li>
</ul>
</div>
<div class="section" id="conclusion">
<h2>Conclusion</h2>
<p>I really like using org for this work. My file is a text file and
easily understood and modified as needed. With a little editing of the
names, I can have a file with each month under a separate headline. I
could keep year-to-date figures as well as compare expenses on a
yearly basis. There is the potential to have a unique identifier for each field.
Tracking utility bills, for example, year over year could come in very handy.</p>
</div>
</div>
    </div>
    <aside class="postpromonav"><nav><ul class="pager hidden-print">
<li class="previous">
                <a href="../tab-completion-in-orgmode/" rel="prev" title="Tab Completion in Orgmode">Previous post</a>
            </li>
            <li class="next">
                <a href="../recurring-tasks-in-orgmode/" rel="next" title="Recurring Tasks in Orgmode">Next post</a>
            </li>
        </ul></nav></aside></article><!--End of body content--><footer id="footer">
            Contents © 2021         <a href="mailto:@rillonline">Rill</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
            
            
        </footer>
</div>
</div>


        <script src="../../../../assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
    </script>
</body>
</html>
